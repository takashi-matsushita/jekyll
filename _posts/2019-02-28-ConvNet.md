---
layout: post
categories: [AI,]
title: ConvNet / 畳み込みニューラルネットワーク
author: Takashi MATSUSHITA
---

コンピュータ画像は画素(ピクセル)の組合せで表現される

<div align="center">
<svg xmlns="http://www.w3.org/2000/svg" width="270" height="60" viewBox="0 0 90 20">
  {% include figures/RGB_image.svg %}
</svg>
</div>

* ピクセル: 色を赤/緑/青の明るさの組合せで表現
* 各色の明るさを 256段階 (8 bits) で表現: 3バイト/ピクセル
* 幾つものピクセルを並べて平面画像を表現
* HD では 192万 (1920x1080) ピクセル. 一眼レフ入門機で 2400万 (6000x4000) ピクセル

全結合層で画像を扱うのは大変なので、画像認識には畳み込み層を使用する. 畳み込みとは...

* 畳み込みフィルターを移動して画像を走査し出力を得る
  * $$z_{i,j} = \sum_{u}\sum_{w} x_{i^\prime, j^\prime}\cdot w_{u,v}$$<br/>
    $$i^\prime = i \times s_h + u$$<br/>
    $$j^\prime = j \times s_w + v$$<br/>
    $$s_h$$: 垂直方向窓移動幅<br/>
    $$s_w$$: 水平方向窓移動幅
  * 5x5 の画像を 3x3 のフィルターを用い移動幅 1 で走査した場合は以下の様になる.

<div align="center">
<svg xmlns="http://www.w3.org/2000/svg" width="400" height="150" viewBox="0 0 400 150">
  {% include figures/convolution.svg %}
</svg>
</div>

画像認識には領域内の代表値で領域を表現するダウンサンプリングも用いる.
* 平均プーリング: 領域内の平均値を使用
* 最大プーリング: 領域内の最大値を使用
  * 4x4 の画像に 2x2 の最大プーリングを使用した場合は以下の様になる.

<div align="center">
<svg xmlns="http://www.w3.org/2000/svg" width="300" height="150" viewBox="0 0 300 150">
  {% include figures/maxpooling.svg %}
</svg>
</div>

以上の様に画像に対しては、小さな領域毎に特徴を抽出してからニューラル・ネットワークを使用する. 生物の画像処理も同様な仕組みとなっている.
